<lm-page-layout>
    <div lmCardPanel>
        <div lmCardPanelTitle>
            <div fxLayout="row">
                <div fxFlex="1 1">
                    Game {{game?.number}}
                </div>
                <div fxFlex>
                    <button mat-icon-button aria-label="Close" (click)="onClose()">
                        <mat-icon>close</mat-icon>
                    </button>
                </div>
            </div>
        </div>
        <div lmCardPanelBody>
            <div fxLayout="row wrap" fxLayoutGap="0.6em">
                <div fxFlex fxLayout="column" fxLayoutGap="0.6em"
                    *ngIf="game?.gameSettings?.scoreSystem === ScoreSystem.AdHoc">
                    <div lmCardPanelContent fxFlex>
                        <lm-game-score-summary [game]="game" [teamScores]="game.teamScores"></lm-game-score-summary>
                    </div>
                </div>
                <ng-container *ngIf="game?.gameSettings?.scoreSystem === ScoreSystem.Rounds">
                    <div fxFlex fxLayout="column" fxLayoutGap="0.6em" [@roundChanged]="selectedRound?.number">
                        <div fxFlex lmCardPanelContent>
                            <lm-game-round-list [game]="game" [rounds]="rounds" (addRound)="onAddRound()"
                                (editRound)="onEditRound($event)" (deleteRound)="onDeleteRound($event)">
                            </lm-game-round-list>
                        </div>
                        <div fxFlex lmCardPanelContent *ngIf="selectedRound">
                            <lm-score-by-round-chart [rounds]="rounds"></lm-score-by-round-chart>
                        </div>
                    </div>
                    <div fxFlex fxLayout="column" fxLayoutGap="0.6em" [@roundChanged]="selectedRound?.number"
                        *ngIf="selectedRound">
                        <div lmPadded lmCardPanelContent *ngIf="selectedRound">
                            <lm-wild-card-indicator class="section" [wildCard]="wildCard"></lm-wild-card-indicator>
                        </div>
                        <div lmPadded lmCardPanelContent>
                            <lm-game-round-form class="section" [round]="selectedRound"
                                (scoreChanged)="onScoreChanged()" (scoreEntered)="onAddRound()">
                            </lm-game-round-form>
                            <lm-paginator *ngIf="selectedRound"
                                [firstDisabled]="!rounds || rounds.length == 0 || selectedRound === rounds[0]"
                                [previousDisabled]="!rounds || rounds.length == 0 || selectedRound === rounds[0]"
                                [nextDisabled]="!rounds || rounds.length == 0 || selectedRound === rounds[rounds.length - 1]"
                                [lastDisabled]="!rounds || rounds.length == 0 || selectedRound === rounds[rounds.length - 1]"
                                (first)="onFirstRound()" (previous)="onPreviousRound()" (next)="onNextRound()"
                                (last)="onLastRound()"></lm-paginator>
                        </div>
                    </div>
                </ng-container>
            </div>
        </div>
    </div>
</lm-page-layout>